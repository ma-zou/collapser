/**
 * @name Collapser
 * @author Malte Zoudlik ma.z0u
 * @version 1.0.2
 * @copyright (c) 2018
 */
 class Collapser{constructor(t){this.params={trigger:".collapser",maxHeight:!1,scrollTo:!1,openFirst:!0,onhold:!1,closeOnOpen:!0},this.params={...this.params,...t},this.status=!1,this.triggerList=document.querySelectorAll(this.params.trigger),this.currentActiveElement=null,this.anker=-1==window.location.hash.indexOf("#")||window.location.hash.length<=1?null:window.location.hash,!1===this.params.onhold&&this.init()}init(){!1===this.status&&(this.triggerList.forEach(t=>{t.addEventListener("click",this.handleClick.bind(this)),t.classList.add("collapser-initialized"),t.nextElementSibling.style.maxHeight=0}),null==this.anker?this.updateStatus(this.triggerList[0],this.params.openFirst,!0):this.openById(window.location.hash,this.triggerList),this.status=!0)}destroy(){this.status&&this.params.onhold&&(this.triggerList.forEach(t=>{t.removeEventListener("click",this.handleClick),t.classList.remove("collapser-initialized"),t.nextElementSibling.style.maxHeight="100%"}),this.status=!1)}handleClick(t){const s=t.currentTarget;s.classList.contains("active")?this.updateStatus(s,!1):(this.params.closeOnOpen&&this.triggerList.forEach(t=>{this.updateStatus(t,!1)}),this.updateStatus(s,!0))}updateStatus(t,s,i=!1){let e,a=t.nextElementSibling;s&&t?(e=a.scrollHeight+"px",t.classList.add("active"),0!=this.params.maxHeight&&this.params.maxHeight<=a.scrollHeight&&(a.classList.add("limited"),e=this.params.maxHeight+"px"),a.style.maxHeight=e,this.currentActiveElement=a,window.addEventListener("resize",this.updateHeight.bind(this)),!0!==i&&!0===this.params.scrollTo&&this.scrollFunction(t)):(t.classList.remove("active"),a.classList.remove("limited"),window.removeEventListener("resize",this.updateHeight),a.style.maxHeight=0)}updateHeight(){const t=this.currentActiveElement.scrollHeight+"px";0!=this.params.maxHeight&&this.params.maxHeight<=e.target.resizeObserver.scrollHeight?(this.currentActiveElement.classList.add("limited"),t=this.params.maxHeight+"px"):this.currentActiveElement.classList.remove("limited"),this.currentActiveElement.style.maxHeight=t}scrollFunction(t){window.setTimeout(()=>{t.scrollIntoView({left:0,block:"start",behavior:"smooth"})},300)}openById(t){this.triggerList.forEach(s=>{this.updateStatus(s,!1),s.id==t.replace("#","")&&(this.updateStatus(s,!0),this.params.scrollTo&&this.scrollFunction(s))})}openByNumber(t){this.triggerList.forEach((s,i)=>{this.updateStatus(s,!1),t==i&&(this.updateStatus(s,!0),this.params.scrollTo&&this.scrollFunction(s))})}closeAll(){this.triggerList.forEach((t,s)=>{this.updateStatus(t,!1)})}}